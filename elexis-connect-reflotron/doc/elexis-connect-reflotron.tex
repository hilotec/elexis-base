%/*******************************************************************************
% * Copyright (c) 2009, medshare GmbH
% * All rights reserved. This program may not be distributed
% * or modified without prior written consent
% *
% * Contributors:
% *    T. Schaller - initial implementation
% *
% *******************************************************************************/
\documentclass[a4paper]{scrartcl}
\usepackage{german}
\usepackage[utf8]{inputenc}
\usepackage{makeidx}
\usepackage{wrapfig}
\makeindex

\usepackage[pdftex]{graphicx}
\DeclareGraphicsExtensions{.pdf,.jpg,.png}

\usepackage{floatflt}
\usepackage[]{hyperref}
\usepackage{color}
\title{Elexis - Reflotron sprint Connector}
\author{medshare GmbH}

\begin{document}

\maketitle
	\begin{center}
		\includegraphics{elexis_logo}
	\end{center}
	\begin{center}
		\includegraphics{roche_logo}
	\end{center}
	\begin{center}
		\includegraphics{reflotron_device}
	\end{center}
\pagebreak

\section{Einf√ºhrung}
Dieses Plugin dient dazu, das Laborger\"at 'Reflotron sprint'\footnote{Firma Roche Diagnostics} an Elexis anzubinden. Mit diesem Plugin k\"onnen die vom Reflotron gemessenen Laborparameter direkt in die Elexis-Datenbank eingelesen werden.

\subsection{Voraussetzungen}
Dieses Plugin ben\"otigt Elexis V1.4.0 oder h\"oher sowie einen Reflotron sprint Ger\"at. Ausserdem wird ein PC mit mindestens einer freien seriellen Schnittstelle (Alternative: USB To RS-232 Adapter) und ein korrekt gerade verdrahtetes serielles Kabel (kein Nullmodemkabel) zur Verbindung des Reflotrons mit dem PC ben\"otigt.

\section{Installation und Konfiguration}
Installieren Sie auf dem im Labor befindlichen PC das Plugin wie gewohnt. Verbinden Sie dann bei \textbf{ausgeschalteten} Ger\"aten den Reflotron mit der einem seriellen Port des Computers. 
\subsection{Daten\"ubertragung am Reflotron einschalten}
Die serielle Datenkommunikation ist im Reflotron standardm\"assig inaktiv. Damit das Reflotron Ger\"at Daten \"uber die Schnittstelle an den Computer sendet, muss die Daten\"ubertragung eingeschaltet werden. Wie dies gemacht wird, ist im Manual zum Reflotron im Kapitel 6 (Insbesondere Seite 6.9) beschrieben. Es folgt hier nur eine Kurzform f\"ur ge\"ubte Techniker:\\
F2, User Level Setup\\
Fn F11\\
Lowlevel Passwort: LOW LEVEL\\
2x Pg Down\\
RS-232\\
\\
Roche empfiehlt folgende Einstellungen:\\
Baudrate: 9600\\
Stop-Bits: 1\\
Parity: None\\
STX/ETX Frame: Yes\\
Autom. Data Trans. To RS 232: Yes\\
BCC: Odd\\
\\
Mit Esc zur\"uck (Werte sind gespeichert).
\subsection{Elexis Konfiguration}
Starten Sie dann Elexis und gehen Sie dort zu \textsc{Datei-Einstellungen-Datenaustausch-Roche Reflotron sprint} (S. Abb. \ref{fig:config}).
\begin{figure}[h]
    \includegraphics{config}
    \caption{Einstellungen Reflotron sprint}
    \label{fig:config}
\end{figure}
Hier stellen Sie den seriellen Port und die Schnittstellenparameter ein. Die Werte m\"ussen mit den Einstellungen auf dem Reflotron Ger\"at \"ubereinstimmen. Wichtig: Nach dem \"Andern dieser Parameter m\"ussen Sie Elexis neu starten.

\section{Verwendung}
\begin{figure}[h]
    \includegraphics{toolbarbutton}
    \caption{Reflotron sprint Daten einlesen}
    \label{fig:toolbarbutton}
\end{figure}
Wenn das Plugin korrekt installiert ist, erscheint in der Labor-View automatisch ein neuer Toolbar Button 'Reflotron sprint' (Abb. \ref{fig:toolbarbutton}). Klicken Sie auf diesem Knopf um die Verbindung mit dem Ger\"at herzustellen. 
\begin{figure}[h]
    \includegraphics{connected}
    \caption{Verbindung zum Reflotron ist aufgebaut}
    \label{fig:connected}
\end{figure}
Die Verbindung bleibt bestehen bis das Timeout gem\"ass Konfiguration abgelaufen ist. Das Reflotron Ger\"at ben\"otigt f\"ur die verschiedene Tests unterschiedlich lang. Jedesmal wenn ein Test abgeschlossen ist wird das Resultat an den Computer gesendet. Wenn alle Resultate empfangen wurden kann die Verbindung abgebrochen werden (Cancel gem\"ass Abb. \ref{fig:connected}).
\begin{figure}[h]
    \includegraphics{messwert}
    \caption{Messwert vom Reflotron eingetroffen}
    \label{fig:messwert}
\end{figure}
Wenn Elexis ein Resultat empf\"angt, wird versucht dieses einem Patienten zuzuordnen. In Abb. \ref{fig:messwert} ist ersichtlich, wie der Patient zugeordnet wird (Beispiel: Muster Franz sind die Angaben aus Elexis und muster wurde auf dem Reflotron eingegeben). Kann der Patient nicht automatisch zugewiesen werden folgt das Fenster mit der Patientenselektion.\\
\\
Es kann passieren, dass der Datenstrom zwischen Reflotron und Computer fehlerhaft ist. In diesem Fall erscheint eine Fehlermeldung (siehe \ref{fig:transmissionerror}). In diesem Fall kann das Profil des Patienten auf dem Reflotron erneut gesendet werden (F2, Profil aufrufen, F10 Patient suchen und F5 Send Profile). Eine genauere Anleitung befindet sich im Manual zum Reflotron auf S. 3.21.
\begin{figure}[h]
    \includegraphics{transmissionerror}
    \caption{Fehlerhafte Daten vom Reflotron eingetroffen}
    \label{fig:transmissionerror}
\end{figure}
\subsection{Anweisungen zum Reflotron}
Damit eine automatische Zuweisung des Patienten m\"oglich wird, muss auf dem Reflotron der Patient der Messung zugeordnet werden.\\
\\
Eingabeformat: \textbf{Namen,Vornamen} (ohne Leerzeichen nach dem Komma!)\\
\\
Der Patientennamen k\"onnen Sie nach Dr\"ucken der Taste Home erfassen und mit Enter auf die aktive Messkammer \"ubernehmen. Das m\"ussen Sie tun, bevor Sie die Messkammer schliessen.\\
\\
Das Reflotron verlangt von Zeit zu Zeit die Checkstreifen. Bei solchen Check Messungen messen Sie keine Patienten Proben in einer andern Messkammer und stellen Sie Elexis dabei auch nicht auf Empfang. Die Fehlermeldung des Ger\"ates "Kein Datentransfer"  k\"onnen Sie in diesem Fall ignorieren.

\section{Plattformen}
Dieses Plugin wurde unter Windows XP und Vista getestet. Beachten Sie bitte, dass unter Linux die seriellen Ports nicht COM1 usw., sondern /dev/ttyS0 usw. heissen.

\section{Kabelspezifikation}
\begin{figure}[h]
    \includegraphics{kabel}
    \caption{Reflotron Kabelkonfiguration}
    \label{fig:kabel}
\end{figure}
Es wird ein normales serielles Kabel ben\"otigt (kein Nulllmodemkabel!). Das Kabel muss vom 25-poligen Stecker (m\"annlich) auf den 9-poligen Stecker (weiblich) gem\"ass Abb. \ref{fig:kabel} verdrahtet sein.
\end{document}
